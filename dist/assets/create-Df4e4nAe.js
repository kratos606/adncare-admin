import{r as a,u as T,U as k,j as e,a as E,B as N}from"./index-CjDFkInu.js";import{B as p,T as q}from"./Box-D2ePpQu4.js";import{C}from"./CircularProgress-B0eNtYyL.js";import{T as S}from"./TextField-2R_2fVAW.js";import{B as A}from"./Button-BdfboGMk.js";import{S as F}from"./Snackbar-CuilL5fl.js";import{A as L}from"./Alert-JAYxnSnU.js";import"./List-BiWVhqcH.js";import"./createSvgIcon-Wb5NpHkq.js";import"./IconButton-CeC_4U9q.js";const Y=()=>{const[o,b]=a.useState(""),[n,z]=a.useState(""),[m,d]=a.useState(!1),[i,t]=a.useState({open:!1,message:"",severity:"success"}),l=T(),{isAuthenticated:B,isLoading:g}=a.useContext(k);!g&&!B&&l("/login");const f=()=>{t({...i,open:!1})},D=async r=>{var x,h,v,y,j;if(r.preventDefault(),!o.trim()){t({open:!0,message:"Name is required.",severity:"warning"});return}if(!n.trim()){t({open:!0,message:"Description is required.",severity:"warning"});return}const c=new FormData;c.append("name",o.trim()),c.append("description",n.trim()),d(!0);try{const s=await E.post(`${N}/specializations`,c,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});t({open:!0,message:"Specialization created successfully!",severity:"success"}),setTimeout(()=>{l("/specializations")},1500)}catch(s){if(console.error("Error creating specialization:",s),((x=s.response)==null?void 0:x.status)===401)t({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),l("/login");else if(((h=s.response)==null?void 0:h.status)===400)t({open:!0,message:s.response.data.message||"Cannot create more than three specializations.",severity:"error"});else if(((v=s.response)==null?void 0:v.status)===422){const u=s.response.data.errors,w=Object.values(u)[0][0];t({open:!0,message:w||"Validation failed.",severity:"error"})}else{const u=((j=(y=s.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to create specialization.";t({open:!0,message:u,severity:"error"})}}finally{d(!1)}};return g?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(C,{})}):e.jsxs(p,{sx:{p:3},children:[e.jsx(q,{variant:"h4",gutterBottom:!0,children:"Create New Specialization"}),e.jsxs(p,{component:"form",onSubmit:D,sx:{mt:2,display:"flex",flexDirection:"column",gap:2,maxWidth:600},children:[e.jsx(S,{label:"Name",variant:"outlined",value:o,onChange:r=>b(r.target.value),required:!0,fullWidth:!0}),e.jsx(S,{label:"Description",variant:"outlined",value:n,onChange:r=>z(r.target.value),multiline:!0,rows:4,required:!0,fullWidth:!0}),e.jsx(A,{type:"submit",variant:"contained",color:"primary",disabled:m,sx:{alignSelf:"flex-start"},children:m?e.jsx(C,{size:24}):"Create"})]}),e.jsx(F,{open:i.open,autoHideDuration:6e3,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(L,{onClose:f,severity:i.severity,sx:{width:"100%"},children:i.message})})]})};export{Y as default};
