import{r as u,j as t,a as S,B as d}from"./index-CdkbwK6B.js";import{D as T}from"./Delete-kRsdOOVQ.js";import{A as y}from"./Add-BW1xvOuA.js";import{B,T as p}from"./Box-DAti2-1c.js";import{A as _}from"./Alert-yMGXwrAF.js";import{G as n}from"./Grid-DnHPB7Lp.js";import{T as c}from"./TextField-A2G-ApWF.js";import{S as L}from"./Stack-Rq1LG8dl.js";import{I as W}from"./IconButton--_e1gMNA.js";import{B as b}from"./Button-DNkXxOpl.js";import"./createSvgIcon-Dch7dBPN.js";import"./List-DiWJlGpm.js";import"./useThemeProps-BR57ylZ7.js";const H=()=>{const[r,l]=u.useState({title:"",buttons:[""],description:"",image:null,image_path:"",section_title:"",section_description:"",cta_button:""}),[j,h]=u.useState(""),[g,o]=u.useState(""),[x,v]=u.useState("");u.useEffect(()=>{const s=setTimeout(()=>{o(""),v("")},5e3);return()=>clearTimeout(s)},[g,x]),u.useEffect(()=>{(async()=>{try{const e=(await S.get(`${d}/specialite-page`)).data;if(e.status==="success"){const i=e.data;l({...i,buttons:JSON.parse(i.buttons),image:null}),i.image_path&&h(`${d}/storage/${i.image_path}`)}else o("Failed to load existing data")}catch(a){console.error(a),o("Failed to load existing data")}})()},[]);const m=s=>{const{name:a,value:e}=s.target;l(i=>({...i,[a]:e}))},C=s=>{const a=s.target.files[0];if(a){if(a.size>2048e3){o("Image size should be less than 2MB");return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml"].includes(a.type)){o("Invalid file type. Please upload an image (JPEG, PNG, JPG, GIF, SVG)");return}l(e=>({...e,image:a})),h(URL.createObjectURL(a))}},I=()=>{if(r.buttons.length>=4){o("You can only add up to 4 buttons.");return}l(s=>({...s,buttons:[...s.buttons,""]}))},P=s=>{l(a=>({...a,buttons:a.buttons.filter((e,i)=>i!==s)}))},w=(s,a)=>{l(e=>({...e,buttons:e.buttons.map((i,f)=>f===s?a:i)}))},D=async s=>{s.preventDefault();const a=new FormData;Object.keys(r).forEach(e=>{e==="buttons"?r[e].forEach(i=>{a.append(`${e}[]`,i)}):(e==="image"&&r[e]||e!=="image_path"&&e!=="image")&&a.append(e,r[e])});try{const i=(await S.post(`${d}/specialite-page`,a,{headers:{"Content-Type":"multipart/form-data"}})).data;i.status==="success"?(v("Specialite page updated successfully"),i.data.image_path&&(h(`${d}/storage/${i.data.image_path}`),l(f=>({...f,image_path:i.data.image_path,image:null})))):o("Failed to update specialite page")}catch(e){console.error(e),o("An error occurred while submitting the form")}};return t.jsxs(B,{children:[t.jsx(p,{variant:"h4",gutterBottom:!0,children:"Specialite Page Settings"}),g&&t.jsx(_,{severity:"error",sx:{mb:2},children:g}),x&&t.jsx(_,{severity:"success",sx:{mb:2},children:x}),t.jsx("form",{onSubmit:D,children:t.jsxs(n,{container:!0,spacing:3,children:[t.jsx(n,{item:!0,xs:12,children:t.jsx(c,{fullWidth:!0,label:"Title",name:"title",value:r.title,onChange:m,inputProps:{maxLength:24},required:!0})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(c,{fullWidth:!0,multiline:!0,rows:4,label:"Description",name:"description",value:r.description,inputProps:{maxLength:250},onChange:m,required:!0})}),t.jsxs(n,{item:!0,xs:12,children:[t.jsx(p,{variant:"subtitle1",gutterBottom:!0,sx:{mb:2},children:"Buttons"}),r.buttons.length>=4&&t.jsx(p,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"Maximum of 4 buttons reached."}),r.buttons.map((s,a)=>t.jsxs(L,{direction:"row",spacing:2,sx:{mb:2},alignItems:"center",children:[t.jsx(c,{fullWidth:!0,label:`Button ${a+1}`,value:s,inputProps:{maxLength:20},onChange:e=>w(a,e.target.value),required:!0}),t.jsx(W,{onClick:()=>P(a),disabled:r.buttons.length===1,children:t.jsx(T,{})})]},a)),t.jsx(b,{startIcon:t.jsx(y,{}),onClick:I,variant:"outlined",sx:{mb:2},disabled:r.buttons.length>=4,children:"Add Button"})]}),t.jsxs(n,{item:!0,xs:12,children:[t.jsxs(b,{variant:"contained",component:"label",fullWidth:!0,sx:{mb:2},children:["Upload Image",t.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:C})]}),j&&t.jsxs(B,{sx:{mt:2,mb:2},children:[t.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:r.image?"New Image Preview:":"Current Image:"}),t.jsx("img",{src:j,alt:"Preview",style:{maxWidth:"100%",maxHeight:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"4px"}})]})]}),t.jsx(n,{item:!0,xs:12,children:t.jsx(c,{fullWidth:!0,label:"Section Title",name:"section_title",value:r.section_title,inputProps:{maxLength:24},onChange:m,required:!0})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(c,{fullWidth:!0,multiline:!0,rows:4,label:"Section Description",name:"section_description",inputProps:{maxLength:250},value:r.section_description,onChange:m,required:!0})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(c,{fullWidth:!0,label:"CTA Button",name:"cta_button",inputProps:{maxLength:15},value:r.cta_button,onChange:m,required:!0})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(b,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,children:"Save Changes"})})]})})]})};export{H as default};
