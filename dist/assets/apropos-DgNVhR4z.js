import{r as d,j as e,a as B,B as m}from"./index-CdkbwK6B.js";import{D as F}from"./Delete-kRsdOOVQ.js";import{A as T}from"./Add-BW1xvOuA.js";import{B as g,T as x}from"./Box-DAti2-1c.js";import{C as D}from"./CircularProgress-DWt0ae3m.js";import{A as I}from"./Alert-yMGXwrAF.js";import{G as o}from"./Grid-DnHPB7Lp.js";import{T as u}from"./TextField-A2G-ApWF.js";import{S as E}from"./Stack-Rq1LG8dl.js";import{I as q}from"./IconButton--_e1gMNA.js";import{B as h}from"./Button-DNkXxOpl.js";import"./createSvgIcon-Dch7dBPN.js";import"./List-DiWJlGpm.js";import"./useThemeProps-BR57ylZ7.js";const Z=()=>{const[s,c]=d.useState({title:"",bullets:[""],video:null,image:null,experience:"",section_title:"",section_subtitle:"",section_description:"",section_profile_image:null,section_name:""}),[a,f]=d.useState({video:"",image:"",section_profile_image:""}),[j,l]=d.useState(""),[v,y]=d.useState(""),[C,P]=d.useState(!1),[A,L]=d.useState(!0);d.useEffect(()=>((async()=>{try{const i=await B.get(`${m}/apropos-page`);if(i.data.status==="success"){const t=i.data.data;c({title:t.title||"",bullets:t.bullets||[""],video:null,image:null,experience:t.experience||"",section_title:t.section_title||"",section_subtitle:t.section_subtitle||"",section_description:t.section_description||"",section_profile_image:null,section_name:t.section_name||""}),f({video:`${m}/storage/`+t.video||"",image:`${m}/storage/`+t.image||"",section_profile_image:`${m}/storage/`+t.section_profile_image||""})}else l(i.data.message||"Failed to fetch Apropos Page.")}catch(i){console.error(i),l("An error occurred while fetching the Apropos Page.")}finally{L(!1)}})(),()=>{a.video&&URL.revokeObjectURL(a.video),a.image&&URL.revokeObjectURL(a.image),a.section_profile_image&&URL.revokeObjectURL(a.section_profile_image)}),[]);const p=r=>{const{name:i,value:t}=r.target;c(n=>({...n,[i]:t}))},_=r=>{const{name:i,files:t}=r.target;if(t.length>0){const n=t[0];if(n.size>2*1024*1024){l("File size should be less than 2MB.");return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml","image/webp"].includes(n.type)){l("Invalid file type. Please upload an image (JPEG, PNG, JPG, GIF, SVG, WEBP).");return}c(b=>({...b,[i]:n})),f(b=>({...b,[i]:URL.createObjectURL(n)}))}},W=(r,i)=>{const t=[...s.bullets];t[r]=i,c(n=>({...n,bullets:t}))},R=()=>{c(r=>({...r,bullets:[...r.bullets,""]}))},w=r=>{const i=s.bullets.filter((t,n)=>n!==r);c(t=>({...t,bullets:i.length>0?i:[""]}))},U=async r=>{r.preventDefault(),l(""),y(""),P(!0);const i=new FormData;i.append("title",s.title),s.bullets.forEach((t,n)=>{i.append(`bullets[${n}]`,t)}),i.append("experience",s.experience),i.append("section_title",s.section_title),i.append("section_subtitle",s.section_subtitle),i.append("section_description",s.section_description),i.append("section_name",s.section_name),s.image&&i.append("image",s.image),s.video&&i.append("video",s.video),s.section_profile_image&&i.append("section_profile_image",s.section_profile_image);try{const t=await B.post(`${m}/apropos-page`,i,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.status==="success"){y("Apropos Page updated successfully.");const n=t.data.data;f({video:n.video_url||"",image:n.image_url||"",section_profile_image:n.section_profile_image_url||""}),c(S=>({...S,video:null,image:null,section_profile_image:null}))}else l(t.data.message||"Failed to update Apropos Page.")}catch(t){if(console.error(t),t.response&&t.response.data&&t.response.data.errors){const n=Object.values(t.response.data.errors).flat().join(" ");l(n)}else l("An error occurred while updating the Apropos Page.")}finally{P(!1)}};return A?e.jsx(g,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:e.jsx(D,{})}):e.jsxs(g,{sx:{p:4},children:[e.jsx(x,{variant:"h4",gutterBottom:!0,children:"Apropos Page Settings"}),j&&e.jsx(I,{severity:"error",sx:{mb:2},children:j}),v&&e.jsx(I,{severity:"success",sx:{mb:2},children:v}),e.jsx("form",{onSubmit:U,children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Title",name:"title",inputProps:{maxLength:75},value:s.title,onChange:p,required:!0})}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(x,{variant:"subtitle1",gutterBottom:!0,children:"Bullets"}),s.bullets.map((r,i)=>e.jsxs(E,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(u,{fullWidth:!0,label:`Bullet ${i+1}`,value:r,inputProps:{maxLength:20},onChange:t=>W(i,t.target.value),required:!0}),e.jsx(q,{onClick:()=>w(i),disabled:s.bullets.length===1,children:e.jsx(F,{color:"secondary"})})]},i)),e.jsx(h,{startIcon:e.jsx(T,{}),onClick:R,variant:"outlined",children:"Add Bullet"})]}),e.jsx(o,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,multiline:!0,rows:4,label:"Experience",name:"experience",inputProps:{maxLength:25},value:s.experience,onChange:p,required:!0})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(u,{fullWidth:!0,label:"Section Title",name:"section_title",inputProps:{maxLength:15},value:s.section_title,onChange:p,required:!0})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(u,{fullWidth:!0,label:"Section Subtitle",name:"section_subtitle",inputProps:{maxLength:50},value:s.section_subtitle,onChange:p,required:!0})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,multiline:!0,rows:4,label:"Section Description",name:"section_description",InputProps:{maxLength:250},value:s.section_description,onChange:p,required:!0})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(u,{fullWidth:!0,label:"Section Name",name:"section_name",inputProps:{maxLength:15},value:s.section_name,onChange:p,required:!0})}),e.jsxs(o,{item:!0,xs:12,sm:6,children:[e.jsxs(h,{variant:"contained",component:"label",fullWidth:!0,sx:{mb:2},children:["Upload Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",name:"image",onChange:_})]}),a.image&&e.jsxs(g,{sx:{mt:2},children:[e.jsx(x,{variant:"subtitle2",children:"Current Image:"}),e.jsx("img",{src:a.image,alt:"Current Image",style:{maxWidth:"100%",maxHeight:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"4px"}})]})]}),e.jsxs(o,{item:!0,xs:12,sm:6,children:[e.jsxs(h,{variant:"contained",component:"label",fullWidth:!0,sx:{mb:2},children:["Upload Video (Image Format)",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",name:"video",onChange:_})]}),a.video&&e.jsxs(g,{sx:{mt:2},children:[e.jsx(x,{variant:"subtitle2",children:"Current Video (Image):"}),e.jsx("img",{src:a.video,alt:"Current Video",style:{maxWidth:"100%",maxHeight:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"4px"}})]})]}),e.jsxs(o,{item:!0,xs:12,sm:6,children:[e.jsxs(h,{variant:"contained",component:"label",fullWidth:!0,sx:{mb:2},children:["Upload Section Profile Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",name:"section_profile_image",onChange:_})]}),a.section_profile_image&&e.jsxs(g,{sx:{mt:2},children:[e.jsx(x,{variant:"subtitle2",children:"Current Section Profile Image:"}),e.jsx("img",{src:a.section_profile_image,alt:"Current Section Profile",style:{maxWidth:"100%",maxHeight:"200px",border:"1px solid #ddd",borderRadius:"4px",padding:"4px"}})]})]}),e.jsx(o,{item:!0,xs:12,children:e.jsx(h,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,disabled:C,children:C?"Saving...":"Save Changes"})})]})})]})};export{Z as default};
