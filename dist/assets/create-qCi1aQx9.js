import{r as s,u as V,U as k,j as e,a as q,B as F}from"./index-CjDFkInu.js";import{B as l,T as y}from"./Box-D2ePpQu4.js";import{C as j}from"./CircularProgress-B0eNtYyL.js";import{T as b}from"./TextField-2R_2fVAW.js";import{B as C}from"./Button-BdfboGMk.js";import{S as L}from"./Snackbar-CuilL5fl.js";import{A}from"./Alert-JAYxnSnU.js";import"./List-BiWVhqcH.js";import"./createSvgIcon-Wb5NpHkq.js";import"./IconButton-CeC_4U9q.js";const H=()=>{const[d,S]=s.useState(""),[c,T]=s.useState(""),[a,B]=s.useState(null),[p,m]=s.useState(!1),[i,r]=s.useState({open:!1,message:"",severity:"success"}),u=V(),{isAuthenticated:U,isLoading:g}=s.useContext(k);!g&&!U&&u("/login");const x=()=>{r({...i,open:!1})},w=async t=>{var h,f,v;if(t.preventDefault(),!d.trim()){r({open:!0,message:"Title is required.",severity:"warning"});return}if(!a){r({open:!0,message:"Video file is required.",severity:"warning"});return}const o=new FormData;o.append("title",d),o.append("description",c),o.append("video",a),m(!0);try{const n=await q.post(`${F}/galerie-video`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});r({open:!0,message:"Video uploaded successfully!",severity:"success"}),setTimeout(()=>{u("/galerie/videos")},1500)}catch(n){if(console.error("Error uploading video:",n),((h=n.response)==null?void 0:h.status)===401)r({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),u("/login");else{const D=((v=(f=n.response)==null?void 0:f.data)==null?void 0:v.message)||"Failed to upload video.";r({open:!0,message:D,severity:"error"})}}finally{m(!1)}};return g?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(j,{})}):e.jsxs(l,{sx:{p:3},children:[e.jsx(y,{variant:"h4",gutterBottom:!0,children:"Upload New Video"}),e.jsxs(l,{component:"form",onSubmit:w,sx:{mt:2,display:"flex",flexDirection:"column",gap:2,maxWidth:600},children:[e.jsx(b,{label:"Title",variant:"outlined",value:d,onChange:t=>S(t.target.value),required:!0}),e.jsx(b,{label:"Description",variant:"outlined",value:c,onChange:t=>T(t.target.value),required:!0}),e.jsxs(C,{variant:"contained",component:"label",children:["Upload Video",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:t=>{t.target.files&&t.target.files[0]&&B(t.target.files[0])},required:!0})]}),a&&e.jsxs(l,{children:[e.jsx(y,{variant:"body2",children:"Video Preview:"}),e.jsx("img",{src:URL.createObjectURL(a),style:{maxWidth:"100%",height:"auto",marginTop:"10px"}})]}),e.jsx(C,{type:"submit",variant:"contained",color:"primary",disabled:p,children:p?e.jsx(j,{size:24}):"Upload"})]}),e.jsx(L,{open:i.open,autoHideDuration:6e3,onClose:x,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(A,{onClose:x,severity:i.severity,sx:{width:"100%"},children:i.message})})]})};export{H as default};
