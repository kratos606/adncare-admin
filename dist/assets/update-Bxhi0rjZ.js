import{k as L,r as s,u as T,U as q,j as t,a as C,B}from"./index-CdkbwK6B.js";import{B as f,T as N}from"./Box-DAti2-1c.js";import{C as E}from"./CircularProgress-DWt0ae3m.js";import{T as k}from"./TextField-A2G-ApWF.js";import{B as F}from"./Button-DNkXxOpl.js";import{S as I}from"./Snackbar-CiqW6jiD.js";import{A as W}from"./Alert-yMGXwrAF.js";import"./List-DiWJlGpm.js";import"./createSvgIcon-Dch7dBPN.js";import"./IconButton--_e1gMNA.js";const Z=()=>{const{id:h}=L(),[p,x]=s.useState(""),[m,v]=s.useState(""),[O,w]=s.useState(null),[D,P]=s.useState(!0),[y,S]=s.useState(!1),[u,e]=s.useState({open:!1,message:"",severity:"success"}),a=T(),{isAuthenticated:c,isLoading:d}=s.useContext(q),U=async()=>{var r,l;try{const n=(await C.get(`${B}/specializations/${h}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data;w(n),x(n.name),v(n.description)}catch(i){console.error("Error fetching specialization:",i),((r=i.response)==null?void 0:r.status)===401?(e({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),a("/login")):((l=i.response)==null?void 0:l.status)===404?(e({open:!0,message:"Specialization not found.",severity:"error"}),a("/specializations")):e({open:!0,message:"Failed to fetch specialization.",severity:"error"})}finally{P(!1)}};s.useEffect(()=>{c&&U()},[c]),s.useEffect(()=>{!d&&!c&&a("/login")},[d,c,a]);const z=()=>{e({...u,open:!1})},$=async r=>{var l,i,n,j,b;if(r.preventDefault(),!p.trim()){e({open:!0,message:"Name is required.",severity:"warning"});return}if(!m.trim()){e({open:!0,message:"Description is required.",severity:"warning"});return}S(!0);try{const o=await C.put(`${B}/specializations/${h}`,{name:p,description:m},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e({open:!0,message:"Specialization updated successfully!",severity:"success"}),setTimeout(()=>{a("/specializations")},1500)}catch(o){if(console.error("Error updating specialization:",o),((l=o.response)==null?void 0:l.status)===401)e({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),a("/login");else if(((i=o.response)==null?void 0:i.status)===404)e({open:!0,message:"Specialization not found.",severity:"error"}),a("/specializations");else if(((n=o.response)==null?void 0:n.status)===422){const g=o.response.data.errors,A=Object.values(g)[0][0];e({open:!0,message:A||"Validation failed.",severity:"error"})}else{const g=((b=(j=o.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to update specialization.";e({open:!0,message:g,severity:"error"})}}finally{S(!1)}};return D||d?t.jsx(f,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsx(E,{})}):t.jsxs(f,{sx:{p:3},children:[t.jsx(N,{variant:"h4",gutterBottom:!0,children:"Update Specialization"}),t.jsxs(f,{component:"form",onSubmit:$,sx:{mt:2,display:"flex",flexDirection:"column",gap:2,maxWidth:600},children:[t.jsx(k,{label:"Name",variant:"outlined",value:p,inputProps:{maxLength:30},onChange:r=>x(r.target.value),required:!0,fullWidth:!0}),t.jsx(k,{label:"Description",variant:"outlined",value:m,inputProps:{maxLength:234},onChange:r=>v(r.target.value),multiline:!0,rows:4,required:!0,fullWidth:!0}),t.jsx(F,{type:"submit",variant:"contained",color:"primary",disabled:y,sx:{alignSelf:"flex-start"},children:y?t.jsx(E,{size:24}):"Update"})]}),t.jsx(I,{open:u.open,autoHideDuration:6e3,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(W,{onClose:z,severity:u.severity,sx:{width:"100%"},children:u.message})})]})};export{Z as default};
