import{r as u,j as s,a as F,B as j}from"./index-CdkbwK6B.js";import{D as T}from"./Delete-kRsdOOVQ.js";import{A as I}from"./Add-BW1xvOuA.js";import{B as b,T as m}from"./Box-DAti2-1c.js";import{C as z}from"./CircularProgress-DWt0ae3m.js";import{A as P}from"./Alert-yMGXwrAF.js";import{G as l}from"./Grid-DnHPB7Lp.js";import{T as c}from"./TextField-A2G-ApWF.js";import{S as L}from"./Stack-Rq1LG8dl.js";import{I as W}from"./IconButton--_e1gMNA.js";import{B as g}from"./Button-DNkXxOpl.js";import"./createSvgIcon-Dch7dBPN.js";import"./List-DiWJlGpm.js";import"./useThemeProps-BR57ylZ7.js";const se=()=>{const[i,n]=u.useState({title:"",features:[{name:"",description:""}],image:null,subtitle:"",description:"",bullets:[{name:"",description:""}]}),[p,h]=u.useState({image:""}),[v,o]=u.useState(""),[S,y]=u.useState(""),[C,w]=u.useState(!1),[D,E]=u.useState(!0);u.useEffect(()=>((async()=>{try{const t=await F.get(`${j}/apropos-two`);if(t.data.status==="success"){const e=t.data.data;n({title:e.title||"",features:e.features.length>0?e.features:[{name:"",description:""}],image:null,subtitle:e.subtitle||"",description:e.description||"",bullets:e.bullets.length>0?e.bullets:[{name:"",description:""}]}),h({image:`${j}/storage/`+e.image||""})}else o(t.data.message||"Failed to fetch Apropos Section Two.")}catch(t){console.error(t),o("An error occurred while fetching Apropos Section Two.")}finally{E(!1)}})(),()=>{p.image&&URL.revokeObjectURL(p.image)}),[]);const f=r=>{const{name:t,value:e}=r.target;n(a=>({...a,[t]:e}))},B=(r,t,e)=>{const a=[...i.features];a[r][t]=e,n(d=>({...d,features:a}))},q=()=>{n(r=>({...r,features:[...r.features,{name:"",description:""}]}))},G=r=>{const t=i.features.filter((e,a)=>a!==r);n(e=>({...e,features:t.length>0?t:[{name:"",description:""}]}))},A=(r,t,e)=>{const a=[...i.bullets];a[r][t]=e,n(d=>({...d,bullets:a}))},R=()=>{n(r=>({...r,bullets:[...r.bullets,{name:"",description:""}]}))},$=r=>{const t=i.bullets.filter((e,a)=>a!==r);n(e=>({...e,bullets:t.length>0?t:[{name:"",description:""}]}))},k=r=>{const{name:t,files:e}=r.target;if(e.length>0){const a=e[0];if(a.size>2*1024*1024){o("Image file size should be less than 2MB.");return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml","image/webp"].includes(a.type)){o("Invalid image type. Please upload a JPEG, PNG, JPG, GIF, SVG, or WEBP image.");return}n(x=>({...x,[t]:a})),h(x=>({...x,[t]:URL.createObjectURL(a)}))}},U=async r=>{r.preventDefault(),o(""),y(""),w(!0);const t=new FormData;t.append("title",i.title),i.features.forEach((e,a)=>{t.append(`features[${a}][name]`,e.name),t.append(`features[${a}][description]`,e.description)}),t.append("subtitle",i.subtitle),t.append("description",i.description),i.bullets.forEach((e,a)=>{t.append(`bullets[${a}][name]`,e.name),t.append(`bullets[${a}][description]`,e.description)}),i.image&&t.append("image",i.image);try{const e=await F.post(`${j}/apropos-two`,t,{headers:{"Content-Type":"multipart/form-data"}});if(e.data.status==="success"){y("Apropos Section Two updated successfully.");const a=e.data.data;h({image:a.image_url||""}),n(d=>({...d,image:null}))}else o(e.data.message||"Failed to update Apropos Section Two.")}catch(e){if(console.error(e),e.response&&e.response.data&&e.response.data.errors){const a=Object.values(e.response.data.errors).flat().join(" ");o(a)}else o("An error occurred while updating Apropos Section Two.")}finally{w(!1)}};return D?s.jsx(b,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:s.jsx(z,{})}):s.jsxs(b,{sx:{p:4},children:[s.jsx(m,{variant:"h4",gutterBottom:!0,children:"Apropos Section Two Settings"}),v&&s.jsx(P,{severity:"error",sx:{mb:2},children:v}),S&&s.jsx(P,{severity:"success",sx:{mb:2},children:S}),s.jsx("form",{onSubmit:U,children:s.jsxs(l,{container:!0,spacing:3,children:[s.jsx(l,{item:!0,xs:12,children:s.jsx(c,{fullWidth:!0,label:"Title",name:"title",inputProps:{maxLength:75},value:i.title,onChange:f,required:!0})}),s.jsxs(l,{item:!0,xs:12,children:[s.jsx(m,{variant:"h6",gutterBottom:!0,children:"Features"}),i.features.map((r,t)=>s.jsxs(L,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[s.jsx(c,{label:"Feature Name",value:r.name,inputProps:{maxLength:25},onChange:e=>B(t,"name",e.target.value),required:!0,fullWidth:!0}),s.jsx(c,{label:"Feature Description",value:r.description,onChange:e=>B(t,"description",e.target.value),inputProps:{maxLength:150},required:!0,fullWidth:!0}),s.jsx(W,{onClick:()=>G(t),disabled:i.features.length===1,children:s.jsx(T,{color:"secondary"})})]},t)),s.jsx(g,{startIcon:s.jsx(I,{}),onClick:q,variant:"outlined",sx:{mt:1},children:"Add Feature"})]}),s.jsx(l,{item:!0,xs:12,children:s.jsx(c,{fullWidth:!0,label:"Subtitle",name:"subtitle",value:i.subtitle,onChange:f,inputProps:{maxLength:75},required:!0})}),s.jsx(l,{item:!0,xs:12,children:s.jsx(c,{fullWidth:!0,multiline:!0,rows:4,label:"Description",name:"description",inputProps:{maxLength:250},value:i.description,onChange:f,required:!0})}),s.jsxs(l,{item:!0,xs:12,children:[s.jsx(m,{variant:"h6",gutterBottom:!0,children:"Bullets"}),i.bullets.map((r,t)=>s.jsxs(L,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[s.jsx(c,{label:"Bullet Name",value:r.name,onChange:e=>A(t,"name",e.target.value),required:!0,inputProps:{maxLength:50},fullWidth:!0}),s.jsx(c,{label:"Bullet Description",value:r.description,onChange:e=>A(t,"description",e.target.value),required:!0,fullWidth:!0,inputProps:{maxLength:150}}),s.jsx(W,{onClick:()=>$(t),disabled:i.bullets.length===1,children:s.jsx(T,{color:"secondary"})})]},t)),s.jsx(g,{startIcon:s.jsx(I,{}),onClick:R,variant:"outlined",sx:{mt:1},children:"Add Bullet"})]}),s.jsxs(l,{item:!0,xs:12,children:[s.jsxs(g,{variant:"contained",component:"label",fullWidth:!0,sx:{mb:2},children:["Upload Image",s.jsx("input",{type:"file",hidden:!0,accept:"image/*",name:"image",onChange:k})]}),p.image&&s.jsxs(b,{sx:{mt:2},children:[s.jsx(m,{variant:"subtitle2",children:"Current Image:"}),s.jsx("img",{src:p.image,alt:"Current",style:{maxWidth:"100%",maxHeight:"400px",border:"1px solid #ddd",borderRadius:"4px",padding:"4px"}})]})]}),s.jsx(l,{item:!0,xs:12,children:s.jsx(g,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,disabled:C,children:C?"Saving...":"Save Changes"})})]})})]})};export{se as default};
