import{k as q,r as s,u as N,U as P,j as t,a as C,B}from"./index-CjDFkInu.js";import{B as f,T as F}from"./Box-D2ePpQu4.js";import{C as E}from"./CircularProgress-B0eNtYyL.js";import{T as k}from"./TextField-2R_2fVAW.js";import{B as I}from"./Button-BdfboGMk.js";import{S as L}from"./Snackbar-CuilL5fl.js";import{A as W}from"./Alert-JAYxnSnU.js";import"./List-BiWVhqcH.js";import"./createSvgIcon-Wb5NpHkq.js";import"./IconButton-CeC_4U9q.js";const Z=()=>{const{id:h}=q(),[p,x]=s.useState(""),[d,v]=s.useState(""),[O,w]=s.useState(null),[D,U]=s.useState(!0),[y,S]=s.useState(!1),[c,e]=s.useState({open:!1,message:"",severity:"success"}),a=N(),{isAuthenticated:u,isLoading:m}=s.useContext(P),$=async()=>{var r,l;try{const n=(await C.get(`${B}/specializations/${h}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data;w(n),x(n.name),v(n.description)}catch(i){console.error("Error fetching specialization:",i),((r=i.response)==null?void 0:r.status)===401?(e({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),a("/login")):((l=i.response)==null?void 0:l.status)===404?(e({open:!0,message:"Specialization not found.",severity:"error"}),a("/specializations")):e({open:!0,message:"Failed to fetch specialization.",severity:"error"})}finally{U(!1)}};s.useEffect(()=>{u&&$()},[u]),s.useEffect(()=>{!m&&!u&&a("/login")},[m,u,a]);const z=()=>{e({...c,open:!1})},A=async r=>{var l,i,n,j,b;if(r.preventDefault(),!p.trim()){e({open:!0,message:"Name is required.",severity:"warning"});return}if(!d.trim()){e({open:!0,message:"Description is required.",severity:"warning"});return}S(!0);try{const o=await C.put(`${B}/specializations/${h}`,{name:p,description:d},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e({open:!0,message:"Specialization updated successfully!",severity:"success"}),setTimeout(()=>{a("/specializations")},1500)}catch(o){if(console.error("Error updating specialization:",o),((l=o.response)==null?void 0:l.status)===401)e({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),a("/login");else if(((i=o.response)==null?void 0:i.status)===404)e({open:!0,message:"Specialization not found.",severity:"error"}),a("/specializations");else if(((n=o.response)==null?void 0:n.status)===422){const g=o.response.data.errors,T=Object.values(g)[0][0];e({open:!0,message:T||"Validation failed.",severity:"error"})}else{const g=((b=(j=o.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to update specialization.";e({open:!0,message:g,severity:"error"})}}finally{S(!1)}};return D||m?t.jsx(f,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsx(E,{})}):t.jsxs(f,{sx:{p:3},children:[t.jsx(F,{variant:"h4",gutterBottom:!0,children:"Update Specialization"}),t.jsxs(f,{component:"form",onSubmit:A,sx:{mt:2,display:"flex",flexDirection:"column",gap:2,maxWidth:600},children:[t.jsx(k,{label:"Name",variant:"outlined",value:p,onChange:r=>x(r.target.value),required:!0,fullWidth:!0}),t.jsx(k,{label:"Description",variant:"outlined",value:d,onChange:r=>v(r.target.value),multiline:!0,rows:4,required:!0,fullWidth:!0}),t.jsx(I,{type:"submit",variant:"contained",color:"primary",disabled:y,sx:{alignSelf:"flex-start"},children:y?t.jsx(E,{size:24}):"Update"})]}),t.jsx(L,{open:c.open,autoHideDuration:6e3,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(W,{onClose:z,severity:c.severity,sx:{width:"100%"},children:c.message})})]})};export{Z as default};
