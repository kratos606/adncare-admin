import{r as i,u as D,U as I,j as e,N,L as A,a as f,B as x}from"./index-CjDFkInu.js";import{D as E,G as P,E as $}from"./Edit-DmLPX9Db.js";import{D as L}from"./Delete-CvnuvFEg.js";import{B as r,T as y}from"./Box-D2ePpQu4.js";import{C as j}from"./CircularProgress-B0eNtYyL.js";import{B as T}from"./Button-BdfboGMk.js";import{S as U}from"./Snackbar-CuilL5fl.js";import{A as F}from"./Alert-JAYxnSnU.js";import{I as z}from"./IconButton-CeC_4U9q.js";import"./TextField-2R_2fVAW.js";import"./List-BiWVhqcH.js";import"./createSvgIcon-Wb5NpHkq.js";import"./MenuItem-CN9ZeXoF.js";import"./listItemTextClasses-nIyWsBp7.js";import"./listItemIconClasses-HtZTDNXz.js";import"./Toolbar-BYyhnq4y.js";import"./Badge-DORDaMa7.js";import"./index-CXBuU4mF.js";import"./toPropertyKey-B9UmubNl.js";import"./ListItemText-BcybfKQ7.js";import"./Stack-CqQe12en.js";import"./useThemeProps-CDXnS6-V.js";const le=()=>{const[n,b]=i.useState([]),[v,p]=i.useState(!0),[o,a]=i.useState({open:!1,message:"",severity:"success"}),l=D(),{user:G,isAuthenticated:c,isLoading:w}=i.useContext(I),m=async()=>{var t;p(!0);try{const s=await f.get(`${x}/specializations`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});b(s.data.data)}catch(s){console.error("Error fetching specializations:",s),((t=s.response)==null?void 0:t.status)===401?(a({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),l("/login")):a({open:!0,message:"Failed to fetch specializations.",severity:"error"})}finally{p(!1)}};if(i.useEffect(()=>{c&&m()},[c]),w)return e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(j,{})});if(!c)return e.jsx(N,{to:"/login",replace:!0});const h=()=>{a({...o,open:!1})},S=t=>{l(`/specializations/update/${t}`)},C=async t=>{var s,u,g;if(window.confirm("Are you sure you want to delete this specialization?"))try{await f.delete(`${x}/specializations/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),a({open:!0,message:"Specialization deleted successfully.",severity:"success"}),m()}catch(d){if(console.error("Error deleting specialization:",d),((s=d.response)==null?void 0:s.status)===401)a({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),l("/login");else{const k=((g=(u=d.response)==null?void 0:u.data)==null?void 0:g.message)||"Failed to delete specialization.";a({open:!0,message:k,severity:"error"})}}},B=[{field:"id",headerName:"ID",flex:.5},{field:"name",headerName:"Name",flex:1},{field:"description",headerName:"Description",flex:2},{field:"actions",headerName:"Actions",width:180,sortable:!1,filterable:!1,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(z,{color:"primary",onClick:()=>S(t.row.id),"aria-label":"update",size:"small",children:e.jsx($,{})}),e.jsx(z,{color:"secondary",onClick:()=>C(t.row.id),"aria-label":"delete",size:"small",children:e.jsx(L,{})})]})}];return e.jsxs(r,{sx:{p:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsx(y,{variant:"h4",gutterBottom:!0,children:"Specialization Management"}),e.jsx(T,{variant:"contained",color:"primary",component:A,to:"/specializations/create",sx:{mb:2},disabled:n.length>=3,children:"Create Specialization"})]}),n.length>=3&&e.jsx(y,{variant:"body1",color:"error",sx:{mb:2},children:"You have reached the maximum number of specializations (3). Please delete an existing specialization before adding a new one."}),v?e.jsx(r,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(j,{})}):e.jsx(r,{sx:{height:600,width:"100%"},children:e.jsx(E,{rows:n,columns:B,pageSize:10,rowsPerPageOptions:[10,25,50],components:{Toolbar:P},getRowId:t=>t.id})}),e.jsx(U,{open:o.open,autoHideDuration:6e3,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(F,{onClose:h,severity:o.severity,sx:{width:"100%"},children:o.message})})]})};export{le as default};
