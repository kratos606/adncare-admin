import{r as s,u as F,U as L,j as e,a as k,B as q}from"./index-CjDFkInu.js";import{B as l,T as y}from"./Box-D2ePpQu4.js";import{C as j}from"./CircularProgress-B0eNtYyL.js";import{T as D,F as A,I as P,S as R}from"./TextField-2R_2fVAW.js";import{M as S}from"./MenuItem-CN9ZeXoF.js";import{B as b}from"./Button-BdfboGMk.js";import{S as z}from"./Snackbar-CuilL5fl.js";import{A as E}from"./Alert-JAYxnSnU.js";import"./List-BiWVhqcH.js";import"./createSvgIcon-Wb5NpHkq.js";import"./listItemTextClasses-nIyWsBp7.js";import"./listItemIconClasses-HtZTDNXz.js";import"./IconButton-CeC_4U9q.js";const Z=()=>{const[d,C]=s.useState(""),[a,I]=s.useState(null),[u,T]=s.useState(1),[c,p]=s.useState(!1),[i,r]=s.useState({open:!1,message:"",severity:"success"}),m=F(),{isAuthenticated:w,isLoading:g}=s.useContext(L);!g&&!w&&m("/login");const h=()=>{r({...i,open:!1})},B=async t=>{var x,f,v;if(t.preventDefault(),!d.trim()){r({open:!0,message:"Title is required.",severity:"warning"});return}if(!a){r({open:!0,message:"Image file is required.",severity:"warning"});return}const o=new FormData;o.append("title",d),o.append("image",a),o.append("slider",u),p(!0);try{const n=await k.post(`${q}/images`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});r({open:!0,message:"Image uploaded successfully!",severity:"success"}),setTimeout(()=>{m("/images")},1500)}catch(n){if(console.error("Error uploading image:",n),((x=n.response)==null?void 0:x.status)===401)r({open:!0,message:"Your session has expired. Please login again.",severity:"error"}),m("/login");else{const U=((v=(f=n.response)==null?void 0:f.data)==null?void 0:v.message)||"Failed to upload image.";r({open:!0,message:U,severity:"error"})}}finally{p(!1)}};return g?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(j,{})}):e.jsxs(l,{sx:{p:3},children:[e.jsx(y,{variant:"h4",gutterBottom:!0,children:"Upload New Image"}),e.jsxs(l,{component:"form",onSubmit:B,sx:{mt:2,display:"flex",flexDirection:"column",gap:2,maxWidth:500},children:[e.jsx(D,{label:"Title",variant:"outlined",value:d,onChange:t=>C(t.target.value),required:!0}),e.jsxs(A,{fullWidth:!0,required:!0,children:[e.jsx(P,{id:"slider-label",children:"Slider Type"}),e.jsxs(R,{labelId:"slider-label",value:u,label:"Slider Type",onChange:t=>T(t.target.value),children:[e.jsx(S,{value:1,children:"Slider 1"}),e.jsx(S,{value:2,children:"Slider 2"})]})]}),e.jsxs(b,{variant:"contained",component:"label",children:["Upload Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:t=>{t.target.files&&t.target.files[0]&&I(t.target.files[0])},required:!0})]}),a&&e.jsxs(l,{children:[e.jsx(y,{variant:"body2",children:"Image Preview:"}),e.jsx("img",{src:URL.createObjectURL(a),alt:"Preview",style:{maxWidth:"100%",height:"auto",marginTop:"10px"}})]}),e.jsx(b,{type:"submit",variant:"contained",color:"primary",disabled:c,children:c?e.jsx(j,{size:24}):"Upload"})]}),e.jsx(z,{open:i.open,autoHideDuration:6e3,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(E,{onClose:h,severity:i.severity,sx:{width:"100%"},children:i.message})})]})};export{Z as default};
